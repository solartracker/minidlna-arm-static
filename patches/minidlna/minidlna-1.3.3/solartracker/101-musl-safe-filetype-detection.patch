--- a/monitor.c	2026-01-31 22:57:20.795791811 -0500
+++ b/monitor.c	2026-01-31 23:02:54.312982753 -0500
@@ -341,15 +341,26 @@
 			continue;
 		esc_name = escape_tag(e->d_name, 1);
 		snprintf(path_buf, sizeof(path_buf), "%s/%s", path, e->d_name);
-		switch( e->d_type )
+		/* --- New musl-safe type detection --- */
+		if( e->d_type == DT_UNKNOWN )
 		{
-			case DT_DIR:
-			case DT_REG:
-			case DT_LNK:
-			case DT_UNKNOWN:
-				type = resolve_unknown_type(path_buf, dir_types);
-			default:
-				break;
+		    if( lstat(path_buf, &st) == 0 )
+		    {
+		        if( S_ISDIR(st.st_mode) )
+		            type = TYPE_DIR;
+		        else if( S_ISREG(st.st_mode) )
+		            type = TYPE_FILE;
+		        else
+		            type = TYPE_UNKNOWN;
+		    }
+		    else
+		    {
+		        type = TYPE_UNKNOWN;
+		    }
+		}
+		else
+		{
+		    type = resolve_unknown_type(path_buf, dir_types);
 		}
 		if( type == TYPE_DIR )
 		{
